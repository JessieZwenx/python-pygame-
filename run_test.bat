@REM å…³é—­äº†å‘½ä»¤å›žæ˜¾ï¼Œä¸å…³æ³¨æ‰§è¡Œè¿‡ç¨‹åªå…³æ³¨è¿è¡Œç»“æžœ
@echo off

@REM å°†æ˜¾ç¤ºå­—ä½“ä¸ºä¸­æ–‡
chcp 65001
echo ========================================
echo   è¿è¡Œæ·±ç©ºå“¨ç«™æµ‹è¯•å¥—ä»¶
echo ========================================
echo.

@REM åˆ‡æ¢åˆ°é¡¹ç›®ç›®å½•
cd /d "D:\codestudy\01.HTMLå…¥é—¨\python-game-spacecontrol - å‰¯æœ¬"

echo [1/4] æ£€æŸ¥PythonçŽ¯å¢ƒ...
python --version
if errorlevel 1 (
    echo âŒ Pythonæœªæ­£ç¡®å®‰è£…æˆ–æœªæ·»åŠ åˆ°çŽ¯å¢ƒå˜é‡
    echo è¯·å®‰è£…Python 3.6+ å¹¶ç¡®ä¿pythonå‘½ä»¤å¯ç”¨
    pause
    exit /b 1
)
echo âœ… PythonçŽ¯å¢ƒæ£€æŸ¥é€šè¿‡
echo.

echo [2/4] æ£€æŸ¥é¡¹ç›®æ–‡ä»¶ç»“æž„...
if not exist "main.py" (
    echo âŒ é”™è¯¯ï¼šæœªæ‰¾åˆ°main.pyæ–‡ä»¶
    echo è¯·ç¡®ä¿åœ¨æ­£ç¡®çš„é¡¹ç›®ç›®å½•ä¸­è¿è¡Œ
    pause
    exit /b 1
)

if not exist "tests" (
    echo âŒ é”™è¯¯ï¼šæœªæ‰¾åˆ°testsæµ‹è¯•ç›®å½•
    echo è¯·ç¡®ä¿æµ‹è¯•æ–‡ä»¶å·²æ­£ç¡®åˆ›å»º
    pause
    exit /b 1
)

if not exist "sources" (
    echo âš ï¸ è­¦å‘Šï¼šæœªæ‰¾åˆ°sourcesèµ„æºç›®å½•
    echo æ¸¸æˆå¯èƒ½æ— æ³•æ­£å¸¸æ˜¾ç¤ºå›¾ç‰‡å’ŒéŸ³æ•ˆ
) else (
    echo âœ… èµ„æºç›®å½•å­˜åœ¨
)

echo âœ… é¡¹ç›®æ–‡ä»¶ç»“æž„æ£€æŸ¥é€šè¿‡
echo.

echo [3/4] æ£€æŸ¥æµ‹è¯•æ–‡ä»¶...
if not exist "tests\run_tests.py" (
    echo âŒ é”™è¯¯ï¼šæœªæ‰¾åˆ°æµ‹è¯•è¿è¡Œå™¨ tests\run_tests.py
    pause
    exit /b 1
)

if not exist "tests\test_game.py" (
    echo âŒ é”™è¯¯ï¼šæœªæ‰¾åˆ°å•å…ƒæµ‹è¯•æ–‡ä»¶ tests\test_game.py
    pause
    exit /b 1
)

if not exist "tests\integration_test.py" (
    echo âš ï¸ è­¦å‘Šï¼šæœªæ‰¾åˆ°é›†æˆæµ‹è¯•æ–‡ä»¶ tests\integration_test.py
) else (
    echo âœ… é›†æˆæµ‹è¯•æ–‡ä»¶å­˜åœ¨
)

echo âœ… æµ‹è¯•æ–‡ä»¶æ£€æŸ¥é€šè¿‡
echo.

echo [4/4] å¼€å§‹æ‰§è¡Œæµ‹è¯•å¥—ä»¶...
echo ========================================
echo.
python tests/run_tests.py

@REM æ£€æŸ¥æµ‹è¯•æ‰§è¡Œç»“æžœ
if errorlevel 1 (
    echo.
    echo ========================================
    echo âŒ æµ‹è¯•æ‰§è¡Œå¤±è´¥ï¼
    echo å¯èƒ½çš„åŽŸå› ï¼š
    echo â€¢ æ¸¸æˆä»£ç å­˜åœ¨è¯­æ³•é”™è¯¯
    echo â€¢ æµ‹è¯•ç”¨ä¾‹éªŒè¯å¤±è´¥
    echo â€¢ æ¨¡å—å¯¼å…¥è·¯å¾„é—®é¢˜
    echo.
    echo è¯·æ£€æŸ¥ä¸Šé¢çš„é”™è¯¯ä¿¡æ¯å¹¶ä¿®å¤é—®é¢˜
) else (
    echo.
    echo ========================================
    echo ðŸŽ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼
    echo.
    echo ðŸ“Š æµ‹è¯•è¦†ç›–èŒƒå›´ï¼š
    echo â€¢ èµ„æºç³»ç»Ÿåˆå§‹åŒ–
    echo â€¢ æ¨¡å—æ•°æ®ç»“æž„
    echo â€¢ å‡çº§æˆæœ¬è®¡ç®—
    echo â€¢ æ¸¸æˆç»“æŸæ¡ä»¶
    echo â€¢ æŽ¢ç´¢é€»è¾‘
    echo â€¢ éšæœºæ¨¡å—é€‰æ‹©
    echo â€¢ æ¸¸æˆæ•´ä½“é›†æˆ
    echo.
    echo âœ… æ¸¸æˆä»£ç è´¨é‡è‰¯å¥½ï¼Œå¯ä»¥æ­£å¸¸è¿è¡Œï¼
)

@REM æš‚åœç­‰å¾…ç”¨æˆ·çš„æŒ‰é”®ï¼Œé˜²æ­¢çª—å£è¢«å…³é—­
echo.
echo æŒ‰ä»»æ„é”®å…³é—­çª—å£...
pause > nul